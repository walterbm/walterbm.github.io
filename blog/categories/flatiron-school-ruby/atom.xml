<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: “flatiron&nbsp;school;ruby | WBM Blog]]></title>
  <link href="http://walterbm.github.io/blog/categories/flatiron-school-ruby/atom.xml" rel="self"/>
  <link href="http://walterbm.github.io/"/>
  <updated>2015-06-25T01:36:25-04:00</updated>
  <id>http://walterbm.github.io/</id>
  <author>
    <name><![CDATA[Walter Beller-Morales]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Struct Instruct]]></title>
    <link href="http://walterbm.github.io/blog/2015/06/25/struct-instruct/"/>
    <updated>2015-06-25T01:03:56-04:00</updated>
    <id>http://walterbm.github.io/blog/2015/06/25/struct-instruct</id>
    <content type="html"><![CDATA[<p>Ruby is an amazingly flexible language. For almost every need Ruby provides the tools to craft an elegant and precise solution. Within Ruby is a digital toolshed powerful enough to build massive web application and precise enough to be wielded as a scalpel. Among the many tools available are <code>Struct</code>s.</p>

<h2>What are Structs?</h2>

<p>Despite their archaic name, Structs are simple and very useful. Structs provide a convenient way to bundle a few attributes together without having to explicitly write a class.[1] Basically, Structs are mini-classes with implicit data accessor methods. A Struct can serve as an elegant way to compartmentalize data within a class or serve as a way to build simple data structures without the overhead of a full-grown class.</p>

<h2>How to use a Struct</h2>

<p>Struct construction in Ruby is fairly simple.
<code>ruby
Subway = Struct.new(:name, :line)
</code>
Generally a Struct is manipulated by calling methods the same way a class or other similar object would be used.
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">stop</span> <span class="o">=</span> <span class="no">Subway</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Grand</span> <span class="no">Central</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'><span class="n">stop</span><span class="o">.</span><span class="n">name</span>             <span class="c1">#=&gt; &amp;ldquo;Grand Central&amp;rdquo;</span>
</span><span class='line'><span class="n">stop</span><span class="o">.</span><span class="n">line</span>             <span class="c1">#=&gt; 5&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">stop</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="mi">4</span>
</span><span class='line'><span class="n">stop</span><span class="o">.</span><span class="n">line</span>             <span class="c1">#=&gt; 4</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span>
</span><span class='line'><span class="no">However</span><span class="p">,</span> <span class="n">the</span> <span class="n">strange</span> <span class="n">powers</span> <span class="n">of</span> <span class="n">a</span> <span class="no">Struct</span> <span class="n">allow</span> <span class="n">it</span> <span class="n">to</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span>  <span class="k">in</span> <span class="n">a</span> <span class="nb">hash</span><span class="o">-</span><span class="n">like</span> <span class="n">manner</span><span class="o">.</span> <span class="no">Through</span> <span class="n">this</span> <span class="n">interface</span> <span class="n">symbols</span> <span class="ow">and</span> <span class="n">strings</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">interchangeably</span> <span class="n">as</span> <span class="n">keys</span><span class="o">.</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;ruby</span>
</span><span class='line'><span class="sr">stop[:name]           #=&gt; &amp;ldquo;Grand Central&amp;rdquo;</span>
</span><span class='line'><span class="sr">stop[&amp;ldquo;line&amp;rdquo;]          #=&gt; 4&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">stop</span><span class="o">[&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="nb">name</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="mi">23</span><span class="n">rd</span> <span class="no">Street</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="n">stop</span><span class="o">[</span><span class="ss">:line</span><span class="o">]</span> <span class="o">=</span> <span class="mi">6</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;But wait, that’s not all. For the low price of $0.00 Structs also allow you to define custom Struct methods.</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;Email = Struct.new(:name,:domain) do |email|</span>
</span><span class='line'><span class="sr">  def address</span>
</span><span class='line'><span class="sr">    &amp;ldquo;</span><span class="si">#{</span><span class="nb">name</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="err">‘</span> <span class="err">‘</span><span class="p">,</span><span class="err">’</span><span class="n">_</span><span class="err">’</span><span class="p">)</span><span class="si">}</span><span class="sr">@</span><span class="si">#{</span><span class="n">domain</span><span class="si">}</span><span class="sr">&amp;rdquo;</span>
</span><span class='line'><span class="sr">  end</span>
</span><span class='line'><span class="sr">end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">email_account</span> <span class="o">=</span> <span class="no">Email</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">walter</span> <span class="n">beller</span> <span class="n">morales</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">arpanet</span><span class="o">.</span><span class="n">com</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;)</span>
</span><span class='line'><span class="n">email_account</span><span class="o">.</span><span class="n">address</span> <span class="c1">#=&gt; &amp;ldquo;&lt;a href=&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#108;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#119;&amp;#x61;&amp;#x6c;&amp;#x74;&amp;#x65;&amp;#114;&amp;#x5f;&amp;#98;&amp;#x65;&amp;#108;&amp;#x6c;&amp;#101;&amp;#x72;&amp;#x5f;&amp;#109;&amp;#111;&amp;#114;&amp;#97;&amp;#108;&amp;#101;&amp;#x73;&amp;#x40;&amp;#x61;&amp;#114;&amp;#112;&amp;#97;&amp;#110;&amp;#101;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#109;&quot;&gt;&amp;#x77;&amp;#x61;&amp;#x6c;&amp;#116;&amp;#x65;&amp;#114;&amp;#x5f;&amp;#x62;&amp;#x65;&amp;#108;&amp;#108;&amp;#x65;&amp;#114;&amp;#95;&amp;#x6d;&amp;#x6f;&amp;#x72;&amp;#97;&amp;#108;&amp;#101;&amp;#x73;&amp;#64;&amp;#97;&amp;#x72;&amp;#x70;&amp;#97;&amp;#x6e;&amp;#x65;&amp;#116;&amp;#x2e;&amp;#x63;&amp;#111;&amp;#x6d;&lt;/a&gt;&amp;rdquo;</span>
</span></code></pre></td></tr></table></div></figure>
Truly, Structs are a strange and powerful beast.</p>

<p>This short overview only covers the fundamentals. Structs provide much more functionality including value-equality and access to all the enumerable methods.[2]</p>

<h2>Why use a Struct?</h2>

<p>Structs are ideal for following the guiding mantra of object-oriented design: the <strong>single responsibility principal</strong>. A Struct can be used within classes to normalize the internal data structure or to avoid redundancies. An ordinary class would need superfluous attribute readers and writers before it could replicate the functionality of a Struct.</p>

<p>Of course, Structs are not the solution to every problem. Every tool has its purpose. Structs create public accessors (readers and writers) that could pollute the scope if not managed carefully. Structs are also indadequate when the data structure needs to be flexible since a Struct instance will not accept data that was not explicitly accounted for in the constructor.</p>

<p>But generally, for simple data containers, Structs are preferable over hashes. Structs are faster, carry less overhead, only accept a specific data structure, and are much more powerful thanks to customs methods.[3]</p>

<h2><em>I wanna’a go fast</em></h2>

<p>Structs can also be through of as a hybrid  between classes and hashes. This hybird nature has given them quite a speed advantage over ordinary hashes. For those with the need for speed I set-up a small drag race experiment to test the speed of a Struct vs. a Hash.[4]</p>

<pre><code class="ruby">require ‘benchmark’
include Benchmark
COUNT = 10_000_000

Benchmark.benchmark(CAPTION, 15, FORMAT, “% difference:”) do |x|
  hash_test = x.report(“hash:”) do
    COUNT.times do
      first_programer = {first_name: ‘ada’, last_email: ‘lovelace’}
    end
  end
  struct_test = x.report(“struct:”) do 
    Programer = Struct.new(:first_name, :last_name)
    COUNT.times do
      first_programer = Programer.new(‘ada’,’lovelace’)
    end 
  end
  [((hash_test-struct_test)/hash_test)*100]
end
</code></pre>

<pre><code class="json">                      user     system      total        real
hash:             8.100000   0.020000   8.120000    (8.138051)
struct:           4.270000   0.010000   4.280000    (4.285140)
% difference:     47.283951  50.000000        NaN   (47.344402)
</code></pre>

<p>Over 10 million iterations, a Struct is roughly 47% faster than a hash. Not bad for a relatively unknown Ruby object.</p>

<h2>Deconstructing Ruby</h2>

<p>Ruby inherent simplicity and elegance is made possible by the immense variety of tools the language provides. Structs are only a small tool in the Ruby war chest but a tool you can now confidently wield.</p>

<p>One of the great joys of learning to code is gaining an intimate understanding of your chosen programing language and all the tools it provides. Just like a bicycle or a pen, deeply learning  a pogroming language a can make that language feel less like foreign tool and more like an extension of the mind.</p>

<h3>References &amp; Notes</h3>

<ul>
<li>[1] Metz, Sandi (2012-09-05). Practical Object-Oriented Design in Ruby: An Agile Primer (Addison-Wesley Professional Ruby Series). Pearson Education. Kindle Edition.</li>
<li>[2] <a href="http://ruby-doc.org/core-2.2.0/Struct.html">Official Ruby Documentation (2.2.0) for the Struct class</a></li>
<li>[3] <a href="http://stephaniehoh.github.io/blog/2013/12/28/the-ruby-struct-class/">Stephanie Oh (another great Flatiron School grad) wrote up a great overview of the Struct Class.</a></li>
<li>[4] The comparison uses Ruby’s Benchmark library. I decided to set up the experiment to analyze the actual construction of an instance. The hash test builds an instance of the Hash class and the struct test build an instance of the specific Struct. This seems to mostly closely simulate normal use. An alternate setup iterating over the actual Struct construction would drastically reduce the speed advantage of Structs.</li>
</ul>

]]></content>
  </entry>
  
</feed>
